# --- OpenAPI 3.1: Screen 3 â€“ Conversation Goals (module-specific) ---
# Purpose:
# - Configure how much the conversation module should contribute to the platform daily_goal
# - NO session-level intent here (grammar, formality, etc.)
# - NO platform-level goal here

paths:
  /v1/modules/toshokan_conversation/goals:
    get:
      tags: [ConversationGoals]
      summary: Get conversation module goals for the current user
      operationId: getConversationGoals
      responses:
        "200":
          description: Current conversation module goals.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConversationGoals"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/ServerError"

    put:
      tags: [ConversationGoals]
      summary: Replace conversation module goals for the current user
      operationId: updateConversationGoals
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConversationGoalsUpdate"
      responses:
        "200":
          description: Updated conversation module goals.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConversationGoals"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "422":
          $ref: "#/components/responses/UnprocessableEntity"
        "500":
          $ref: "#/components/responses/ServerError"

components:
  schemas:
    ConversationGoals:
      type: object
      required:
        - daily_unit_target
        - updated_at
      additionalProperties: false
      properties:
        daily_unit_target:
          type: integer
          minimum: 0
          maximum: 500
          description: >
            Daily target units contributed by the conversation module.
            This does NOT replace the platform daily_goal.
            A value of 0 means the module does not contribute to daily progress.

        updated_at:
          $ref: "#/components/schemas/ISODateTime"

    ConversationGoalsUpdate:
      type: object
      required:
        - daily_unit_target
      additionalProperties: false
      properties:
        daily_unit_target:
          type: integer
          minimum: 0
          maximum: 500
